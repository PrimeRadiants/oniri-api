language:
- java
- node_js
jdk:
- oraclejdk8
node_js:
- '6'
services:
- mysql
env:
  global:
  - VERSION=0.1.1
  - secure: ebIkXqkIYqIfkCkm1jUc2MA/lkld7n4+4mEajjiM2wuJloIcoY5elDMZxLw0i3LWCJBCQIHd4+TR24+CFkgalSheHrGNCPUzYmh6neszo325avNaJO2py5CaO6/EMzmreMvWRw52HfRulwqORFh1VucEo/4PKKgxvZOfDEsVYYZj/pQ+oPlnJnDLIwXZKw9RLKURVt/zKI2vuY4xxzTZCnSNYbPmyYWpvRHzWTs//3jfKxsakiMEIFKEoTRw/jYzixI2T8PGodryBCglDwQm6E0hC7zmUAoqZyujTUMXFtJlWqHJCHu7sicmchPUJRPU8MQ3PNyDUIGe4bQFV8DSXiOtsLS/XXQUFQhtSTsfFSKuIzjxYt7CIO7GUq719GzZgcNH/ncJ1TaNl+AOx0FmcUjOZ9i7iig+vGY05PBX8YRAt2rw23xSWh6koVRSvqt+pGaZVDdM0rpVDW45DjmC1+fpbPbAP4NJq/boVuUPdTp1wPAQV70ANdU43YHEap8pyir5aFP657Ic8BhldbKWRmtPRMsBQZ06ryRFUD42ljaPLnIt+ATdaCOWOBCmzO4C4pjjmUoqru0YJiV5BG6PcQBF2A0SPdF8n+Ms7+HFte9FspXvuhW8gTUYVLaG2oL69VLcDnXnjzYiSnRGl3S9gALV3TmAd6tqrF0+N99ilTA=
  - secure: WJofnh72rv37DOV/2YjCSdZ0BI+NWeWQ2DIR4d4UM6kZB/lWpt2YqFfDYbYm9qthcwy3uCo1t+CB9WdnvC8x8KE0H8V2eCT03tW03jcdsOZeVj5H1kFCy5vUUyH5XTqmFCxoou/La/+hM7he9xZw9zOhx/lu0LccbyN7+oXAcQBAnLbZhG7JB4D+LEibWdkuIthpXAag5096c14RNr3sJBM7YMIwMmXBOfFtXSKrS7y35RQLV+W9O8xm3ooAXBIAmXLc1hynwkX/x5iMoNFWbWjPHVDHJ/I/Gpi+oUUxtLO6rSqGd6GkQpNHPXnH4BZ7rQt6MEFHNLHZCa6g+Nwrqv7ZtkI8JUb1MdzvF/GK7xSQEIUkhQsPjfsTrKCieJ9mObPdbs5DXW3ZqCKLW0SpLK+Z1eqFqb7JSE8DvUZiM62TJspxW7mOdaHSjl99uggVxyrbqHoYeZz0f6LSE6Xfm3UZzoFBTJulnHfQWCA7WqOOokmW4ubDJp2pPwFlXAyoXCC3fTMRo3zIssUJy0kmftj1jxCMqBGeqOpjk6O2BAgRB490SdCath1soM3DMccwzg5WkWktVeyTP6qyY7ffN+in3PadcVJTZL7yIZE0a2OQub/1Z7gO5volTfSqBru6LdWV/CGMLgSJzGfKeGUh5jos4KG6nJwRLhQcKSwSIno=
  - secure: Gn/cGqzpQhDfTjFCQ2wUaw4LQ5bL/s3PXFMGwnvF1hOcy+uq94UZF3T943p01tMnr+8peQSG1GJwXWZpYcrq31Nh9s/zWdrPXQCXYnKCy97hVGgGiGHHRzyQLPv9UI5dO7mb73L4TpBRunz32Z2HSS2cePPlZUksVq5PXl0HDNT9/56XJLEDEdUnMgB0VjqQXEICnzfHJknf5RrY5cVdUTEdhxAzkjPbAiOuWcPcn+SLmlST2rlpdRLca3j6JyBzC5LYS4XNbJZInBP742iSnVNh7Jp9ZPTQ71nkk2rSAhgGh7bx61BPSKlkxe2OACucCcirWJMtDSFRIIimBDb8oHBelFwYMCBLFwNvjSGpTGb/fxiv2fi6u47haQ7+AJy5wugDOOBAwJjUWYW9Pn5/++yCduuAfYfx9R1VaPpRESGbhQzClwMZZ2xKKQdYu9+KcUStd2UzCM8p+F+eQv4aUe32hwpqnnI+rD2CJq09x5f3pTsX6y73h8JjkC6lA+5F+eKdwPiwmfZlTnS/pqnZ131apHXip21GEbI7l0qi78RZxJwlfi2ngnWO8RX+Qt5rG5ID3NFBURtByN+zHP6/BcjeNW//EI+nat8CdB2UGTkQMUhot/GRoK6ye9SfDT+y4dfyT1GnOnSuupwRls79TKjHryPxzrxGinQY825xr2I=
  - secure: CA0t41UW3xYERoOWc2giNUKGDsHlk0izqKNSQbHIeSSaoVQ3u41ncanjykJ60dSdJ+EufGTaqSk/ABHXTj+qQ6jLu+Fp+hNBnbvowl0a0xK9y+zh8EMnYhY6/xm88DzB0Gj70PEP9CdRPd7geXgGk+kJ0XcQorlEh6VNgYrJyHBV0ZxhDyMcnCoThbt5VYBe3g0qtOk/10OxTAdkW2ajI77Ego/gBBw1MNhvxCjHBIpaa6q1SM2HM58aoUIZHsYSK85pYz3KlPnQFkpuxwkCv+OuM2zJ43W/+Bg21BBnFbArsmXP1WI150SpxPJBVfP05s2Y0u87uaJXMq6xPhjLhAgYBDwB1bZiLd1iyx9ZQY1ChPnlciXzb4dctpuI83encLZChn/UFcGymWC0stUZoL3kcn6oDFcOOT+ryfpgUZg1kQEaisDAxG/bwJUM8yrydRo+N61/PPiIJTSgOrqjRP3fJP7W8e1ce9+Y2Obcp/NAeaI9YSSn5kwsHRBJMgv/rYtCT7Yr/EDmIC+Pq5rdzPj/+7rF8OgHtmwPqZ8o4rp37JDyR9gvIXDnlIqHE11yYLaDJCVeEMgtqL91vju4JXVLA4CW50zXxn+Fu/qemnIHgzQU2LxYfNzR9H98s3n51AG0PrKNU3cLOCKMH1JOEWGOsy03Xxv3d/F1BOmh/HI=
  - secure: dPsHYvqUHtV6P5BO9Pi6KarRzs2G1LOXcOTlvaPdTbvl8GMO3/sLTHNEopzdpAr1XRDiTgBQ+GB6Aw3zF7HffLMSkn60ZKG0pTfzefAuNAaUycD/gd4HcTrnpMncVdj29CY4GcLk5FGohQ88eFuuM0len9sJkq3HNGlD74iAcQ1d+jXQ6XN/IiRoFV7hMcrGJucdLwJtVAd1CQuuO2u2prZCq0zgTx0M2Ki/GGemPbAU6dWix/3Parh+kAgU0YVe6cKylFlvCCPglDoIsHddzE6okWTENtOJGr6gE2tgN7BxIVpa9OuVtd5MimDZqpMdkgdv50jNsdgx/dmj41bZY5VcYD1FmVMC2azdTkZ8YMTVayklurnnNiwU4L/p0ilqk8r6+QTtMWHRmeeZFHKycxXNJmXzjRFlNU19VspUF4c5WAyyzEILZ38pFduKhkF36kjVJDf7YOc2hR4Olgb9+lhrAETBuW+iW2GrL//ru5ObsxgL9xaoKbDc3e/QrqhAnBxtM481AReh+hxxpBp3AWaAnFtoHiaMIGTocqlpRm9HNQE3A5Bc0zmoaJtEqbac3qo3mbVP15qMpMemkUwtJke6VF49tMc4HKxYvH2juLSy8qYu+1y1dW6cnXjfmYCp/Tp1IE2vhpvxeZEtmNXpC6dGQTCpdD+jHcL1psw3Ns4=
  - secure: jzd/dMKA3OlPZNfErLixwb5fRxql+gKOJuAkgZX9xpQCFrR0H5tUEAA1ByNCSEhRAI5vfaYIZI4KZNJTmR7NyGgxkdP426tj4u5QerkQFySQ9wyqQPrEX7sjhMrLpOUGP8vM268fDstNP28aiF4yxtetGWm36XM4Ug60d79RLbxc+joHLIfCyRpx7E5+y/lsfTHo8AdUn2oEsvUrLYoq8Rju42jPNYdUes+i4L4tPB6L+j4ZEOwQ1FOqzLWE6VcEPDK2ZxluxJcv9WgUz1+PXTw0QnPPKVj1e7tHL9yteY1ICg5BBSKJ6P5qJ7iJe3SbupXQK7lI7/eawp2B7sVOmp0JoU1/22Na3xY8PxWCH5PgVSxhXpeSEYON0HvxY+1FRiJ8YaGkLfYz7Fy7H/yWT+cXjURMTQyHXMkCzVpGLtOy34JviCm2zoSzZ2FdUtQp1XouSQpBt0rDLgsTbRYXS/A/4yFkIJD35NI0LNiLnKhTCm3rFhItylZc6RtJRDK64Pq8fKwHguEVeoJmTTECrI9avz7EfPgjP8y+2lh+UZZ5lMSbwEwTU3P41DrPjXOtrKhfyez1d3y56UnhDNbpafpt3P+njmcWXDMewqo553w2pJ5dE4U0yQEuozKOzRAW+qIVLj9frhGY3fHPDxNcYA0CnJ51zhV5Rh68Pd703hw=
before_install:
- npm install apidoc -g
- mysql -u root -e 'create database oniri_test;'
- chmod 755 /var/lib/
- mkdir -p /var/lib/primeradiants/oniri-data/novents/
script:
- sed -i "s/<property name=\"hibernate.connection.username\">root<\/property>/<property
  name=\"hibernate.connection.username\">$MYSQL_USER<\/property>/g" src/main/resources/hibernate-annotation.cfg.xml
- sed -i "s/<property name=\"hibernate.connection.password\"><\/property>/<property name=\"hibernate.connection.password\">$MYSQL_PASSWORD<\/property>/g" src/main/resources/hibernate-annotation.cfg.xml
- mvn package
- mvn javadoc:javadoc
- apidoc -o target/site/restapidocs
after_success:
- if [ "$TRAVIS_BRANCH" = "master" ]; then curl --upload-file target/*.war "http://$TOMCAT_USER:$TOMCAT_PASSWORD@164.132.45.5:8080/manager/text/deploy?path=/v1&update=true"; fi
- cd target/site/apidocs/
- find -type f -exec curl --ftp-create-dirs -T {} -u $FTP_USER:$FTP_PASSWORD ftp://ftp.cluster007.ovh.net/doc/oniri/java/$TRAVIS_BRANCH/$VERSION/{}
  \;
- find -type f -exec curl --ftp-create-dirs -T {} -u $FTP_USER:$FTP_PASSWORD ftp://ftp.cluster007.ovh.net/doc/oniri/java/$TRAVIS_BRANCH/latest/{}
  \;
- cd ../restapidocs/
- find -type f -exec curl --ftp-create-dirs -T {} -u $FTP_USER:$FTP_PASSWORD ftp://ftp.cluster007.ovh.net/doc/oniri/rest/$TRAVIS_BRANCH/$VERSION/{}
  \;
- find -type f -exec curl --ftp-create-dirs -T {} -u $FTP_USER:$FTP_PASSWORD ftp://ftp.cluster007.ovh.net/doc/oniri/rest/$TRAVIS_BRANCH/latest/{}
  \;
- cd ../../..
- mvn clean cobertura:cobertura coveralls:report
